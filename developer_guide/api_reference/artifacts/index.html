
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A minimal cloud aimed at small and edge deployments">
      
      
      
        <link rel="canonical" href="https://shakenfist.com/developer_guide/api_reference/artifacts/">
      
      
        <link rel="prev" href="../admin/">
      
      
        <link rel="next" href="../authentication/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.18">
    
    
      
        <title>Artifacts (/artifacts/) - Shaken Fist</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.26e3688c.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#artifacts-artifacts" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Shaken Fist" class="md-header__button md-logo" aria-label="Shaken Fist" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Shaken Fist
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Artifacts (/artifacts/)
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/shakenfist/shakenfist" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Shaken Fist" class="md-nav__button md-logo" aria-label="Shaken Fist" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Shaken Fist
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/shakenfist/shakenfist" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../manifesto/" class="md-nav__link">
        Manifesto
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../features/" class="md-nav__link">
        Features
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../community/" class="md-nav__link">
        Community
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          User Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          User Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/authentication/" class="md-nav__link">
        Authentication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/usage/" class="md-nav__link">
        Usage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/artifacts/" class="md-nav__link">
        Artifacts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/affinity/" class="md-nav__link">
        Affinity
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/consoles/" class="md-nav__link">
        Consoles
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/events/" class="md-nav__link">
        Events
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/objects/" class="md-nav__link">
        Objects
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/metadata/" class="md-nav__link">
        Object Metadata
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          Developer Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Developer Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" checked>
      
      
      
        <label class="md-nav__link" for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
          API reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_6_1">
          <span class="md-nav__icon md-icon"></span>
          API reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../admin/" class="md-nav__link">
        Admin (/admin/)
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Artifacts (/artifacts/)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Artifacts (/artifacts/)
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#fetching-a-remote-url-as-an-image-artifact" class="md-nav__link">
    Fetching a remote URL as an image artifact
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fetching-information-about-an-artifact" class="md-nav__link">
    Fetching information about an artifact
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deleting-artifacts" class="md-nav__link">
    Deleting artifacts
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uploads" class="md-nav__link">
    Uploads
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-an-already-existing-blob-as-a-new-version-of-an-artifact" class="md-nav__link">
    Using an already existing blob as a new version of an artifact
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#removing-a-specific-version-from-an-artifact" class="md-nav__link">
    Removing a specific version from an artifact
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-the-maximum-number-of-versions-of-an-artifact" class="md-nav__link">
    Setting the maximum number of versions of an artifact
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#downloads" class="md-nav__link">
    Downloads
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sharing-and-unsharing" class="md-nav__link">
    Sharing and unsharing
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metadata" class="md-nav__link">
    Metadata
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../authentication/" class="md-nav__link">
        Authentication (/auth/)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../blob_checksums/" class="md-nav__link">
        Blob Checksums (/blob_checksums/)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../blobs/" class="md-nav__link">
        Blobs (/blobs/)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../instances/" class="md-nav__link">
        Instances (/instances/)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../label/" class="md-nav__link">
        Label (/label/)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../networks/" class="md-nav__link">
        Networks (/networks/)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../interfaces/" class="md-nav__link">
        Network Interfaces (/interfaces/)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../nodes/" class="md-nav__link">
        Nodes (/nodes/)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../upload/" class="md-nav__link">
        Upload (/upload/)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../authentication/" class="md-nav__link">
        Authentication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ci_api_coverage/" class="md-nav__link">
        CI API coverage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../release_process/" class="md-nav__link">
        Release process
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../standards/" class="md-nav__link">
        Standards
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../state_machine/" class="md-nav__link">
        State machine
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../updating_docs/" class="md-nav__link">
        Updating docs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../workflow/" class="md-nav__link">
        Workflow
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
      
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          Operator Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Operator Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../operator_guide/installation/" class="md-nav__link">
        Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../operator_guide/artifacts/" class="md-nav__link">
        Artifacts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../operator_guide/authentication/" class="md-nav__link">
        Authentication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../operator_guide/locks/" class="md-nav__link">
        Locks
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_5" >
      
      
      
        <label class="md-nav__link" for="__nav_7_5" id="__nav_7_5_label" tabindex="0">
          Networking
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_5">
          <span class="md-nav__icon md-icon"></span>
          Networking
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../operator_guide/networking/overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../operator_guide/networking/single_instance/" class="md-nav__link">
        Single Instance
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../operator_guide/power_states/" class="md-nav__link">
        Power States
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../operator_guide/upgrades/" class="md-nav__link">
        Upgrades
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#fetching-a-remote-url-as-an-image-artifact" class="md-nav__link">
    Fetching a remote URL as an image artifact
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fetching-information-about-an-artifact" class="md-nav__link">
    Fetching information about an artifact
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deleting-artifacts" class="md-nav__link">
    Deleting artifacts
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uploads" class="md-nav__link">
    Uploads
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-an-already-existing-blob-as-a-new-version-of-an-artifact" class="md-nav__link">
    Using an already existing blob as a new version of an artifact
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#removing-a-specific-version-from-an-artifact" class="md-nav__link">
    Removing a specific version from an artifact
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-the-maximum-number-of-versions-of-an-artifact" class="md-nav__link">
    Setting the maximum number of versions of an artifact
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#downloads" class="md-nav__link">
    Downloads
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sharing-and-unsharing" class="md-nav__link">
    Sharing and unsharing
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metadata" class="md-nav__link">
    Metadata
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="artifacts-artifacts">Artifacts (/artifacts/)</h1>
<p>The general usage of artifacts is documented in the <a href="/user_guide/artifacts/">user guide</a>. This page documents the API flow interacting with artifacts, as well as the
multi-step process involved with uploading or downloading an artifact.</p>
<details class="note" open="open">
<summary>Note</summary>
<p>For a detailed reference on the state machine for artifacts, see the
<a href="/developer_guide/state_machine/#artifacts">developer documentation on object states</a>.</p>
</details>
<h2 id="fetching-a-remote-url-as-an-image-artifact">Fetching a remote URL as an image artifact</h2>
<p>As discussed in the <a href="/user_guide/artifacts/">user guide</a>, remote URLs can be
stored within a Shaken Fist cluster as artifacts of type <em>image</em>. These artifacts
are often used as the template for disks attached to instances and are the
equivalent to AWS AMIs or OpenStack images in Glance.</p>
<details class="tip" open="open">
<summary>REST API calls</summary>
<ul>
<li><a href="https://sfcbr.shakenfist.com/api/apidocs/#/artifacts/post_artifacts">POST /artifacts</a>: Fetch an image artifact into the cluster.</li>
</ul>
</details>
<details class="example">
<summary>Python API client: cache an artifact</summary>
<p>Note this API call is asynchronous and therefore returns immediately. Use
artifact version information and events to determine if a new version was
fetched and if that fetch is complete.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">shakenfist_client</span> <span class="kn">import</span> <span class="n">apiclient</span>

<span class="n">sf_client</span> <span class="o">=</span> <span class="n">apiclient</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
<span class="n">sf_client</span><span class="o">.</span><span class="n">cache_artifact</span><span class="p">(</span><span class="s1">&#39;https://images.shakenfist.com/debian:11/latest.qcow2&#39;</span><span class="p">)</span>
</code></pre></div>
</details>
<h2 id="fetching-information-about-an-artifact">Fetching information about an artifact</h2>
<p>As expected, you can use a GET REST API call to fetch information about all
artifacts in a namespace, or a specific artifact for more detailed information.
Artifacts also track "events" (see the <a href="/user_guide/events/">user guide</a> for
a general introduction to the Shaken Fist event system).</p>
<details class="tip" open="open">
<summary>REST API calls</summary>
<ul>
<li><a href="https://sfcbr.shakenfist.com/api/apidocs/#/artifacts/get_artifacts">GET /artifacts</a>: List artifacts for a namespace.</li>
<li><a href="https://sfcbr.shakenfist.com/api/apidocs/#/artifacts/get_artifacts__artifact_ref_">GET /artifacts/{artifact_ref}</a>: Get information about a specific artifact.</li>
<li><a href="https://sfcbr.shakenfist.com/api/apidocs/#/artifacts/get_artifacts__artifact_ref__events">GET /artifacts/{artifact_ref}/events</a>: Fetch events for a specific artifact.</li>
</ul>
</details>
<details class="example">
<summary>Python API client: list artifacts</summary>
<p>Note this API call is asynchronous and therefore returns immediately. Use
artifact version information and events to determine if a new version was
fetched and if that fetch is complete.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">shakenfist_client</span> <span class="kn">import</span> <span class="n">apiclient</span>

<span class="n">sf_client</span> <span class="o">=</span> <span class="n">apiclient</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
<span class="n">artifacts</span> <span class="o">=</span> <span class="n">sf_client</span><span class="o">.</span><span class="n">get_artifacts</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;uuid,namespace,type,source_url,versions,state,shared&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">meta</span> <span class="ow">in</span> <span class="n">artifacts</span><span class="p">:</span>
    <span class="n">versions</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> of </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;blobs&#39;</span><span class="p">,</span> <span class="p">[])),</span>
                             <span class="n">meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="s1">&#39;unknown&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">,</span><span class="si">%s</span><span class="s1">,</span><span class="si">%s</span><span class="s1">,</span><span class="si">%s</span><span class="s1">,</span><span class="si">%s</span><span class="s1">,</span><span class="si">%s</span><span class="s1">,</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
          <span class="n">meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;uuid&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n">meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;namespace&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
          <span class="n">meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;artifact_type&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
          <span class="n">meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;source_url&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n">versions</span><span class="p">,</span>
          <span class="n">meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;state&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n">meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;shared&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)))</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>$ python3 example.py
uuid,namespace,type,source_url,versions,state,shared
05e841a7-7e13-4df6-8c04-8932b98885bd,system,image,sf://upload/system/centos-9-stream,1 of 1,created,False
1646bc22-674b-4a46-97e5-f767a6e82d1c,system,image,debian:11,3 of 9,created,False
...
</code></pre></div>
</details>
<details class="example">
<summary>Python API client: get information about a specific artifact</summary>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">shakenfist_client</span> <span class="kn">import</span> <span class="n">apiclient</span>

<span class="n">sf_client</span> <span class="o">=</span> <span class="n">apiclient</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
<span class="n">artifact</span> <span class="o">=</span> <span class="n">sf_client</span><span class="o">.</span><span class="n">get_artifact</span><span class="p">(</span><span class="s1">&#39;05e841a7-7e13-4df6-8c04-8932b98885bd&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">artifact</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>$ python3 example.py
{
    &quot;artifact_type&quot;: &quot;image&quot;,
    &quot;blob_uuid&quot;: &quot;8fa321aa-1e05-43c9-ade1-36d45940d6bd&quot;,
    &quot;blobs&quot;: {
        &quot;1&quot;: {
            &quot;depends_on&quot;: null,
            &quot;instances&quot;: [],
            &quot;reference_count&quot;: 2,
            &quot;size&quot;: 960546304,
            &quot;uuid&quot;: &quot;8fa321aa-1e05-43c9-ade1-36d45940d6bd&quot;
        }
    },
    &quot;index&quot;: 1,
    &quot;max_versions&quot;: 3,
    &quot;metadata&quot;: {},
    &quot;namespace&quot;: &quot;system&quot;,
    &quot;shared&quot;: false,
    &quot;source_url&quot;: &quot;sf://upload/system/centos-9-stream&quot;,
    &quot;state&quot;: &quot;created&quot;,
    &quot;uuid&quot;: &quot;05e841a7-7e13-4df6-8c04-8932b98885bd&quot;,
    &quot;version&quot;: 6
}
</code></pre></div>
</details>
<details class="example">
<summary>Python API client: list events for an artifact</summary>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">shakenfist_client</span> <span class="kn">import</span> <span class="n">apiclient</span>

<span class="n">sf_client</span> <span class="o">=</span> <span class="n">apiclient</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
<span class="n">events</span> <span class="o">=</span> <span class="n">sf_client</span><span class="o">.</span><span class="n">get_artifact_events</span><span class="p">(</span><span class="s1">&#39;05e841a7-7e13-4df6-8c04-8932b98885bd&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">events</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</code></pre></div>
<p>Note that events are returned in reverse chronological order and are limited
to the 100 most recent events.</p>
<div class="highlight"><pre><span></span><code>$ python3 example.py
[
    ...
    {
        &quot;duration&quot;: null,
        &quot;extra&quot;: {},
        &quot;fqdn&quot;: &quot;sf-3&quot;,
        &quot;message&quot;: &quot;artifact fetch complete&quot;,
        &quot;timestamp&quot;: 1684718452.2673004,
        &quot;type&quot;: &quot;audit&quot;
    },
    ...
]
</code></pre></div>
</details>
<h2 id="deleting-artifacts">Deleting artifacts</h2>
<p>Artifacts may be deleted individually, or an entire namespace at a time.</p>
<details class="tip" open="open">
<summary>REST API calls</summary>
<ul>
<li><a href="https://sfcbr.shakenfist.com/api/apidocs/#/artifacts/delete_artifacts">DELETE /artifacts</a>: Delete all artifacts within a specific namespace.</li>
<li><a href="https://sfcbr.shakenfist.com/api/apidocs/#/artifacts/delete_artifacts__artifact_ref_">DELETE /artifacts/{artifact_ref}</a>: Delete a specific artifact.</li>
</ul>
</details>
<details class="example">
<summary>Python API client: delete a single artifact</summary>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">shakenfist_client</span> <span class="kn">import</span> <span class="n">apiclient</span>

<span class="n">sf_client</span> <span class="o">=</span> <span class="n">apiclient</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
<span class="n">sf_client</span><span class="o">.</span><span class="n">delete_artifact</span><span class="p">(</span><span class="s1">&#39;05e841a7-7e13-4df6-8c04-8932b98885bd&#39;</span><span class="p">)</span>
</code></pre></div>
</details>
<details class="example">
<summary>Python API client: delete all artifacts in a namespace</summary>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">shakenfist_client</span> <span class="kn">import</span> <span class="n">apiclient</span>

<span class="n">sf_client</span> <span class="o">=</span> <span class="n">apiclient</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
<span class="n">sf_client</span><span class="o">.</span><span class="n">delete_all_artifacts</span><span class="p">(</span><span class="s1">&#39;mynamespace&#39;</span><span class="p">)</span>
</code></pre></div>
</details>
<h2 id="uploads">Uploads</h2>
<p>Artifact uploads normally require multiple HTTP requests in order to complete.
This is because artifacts are often very large, and the REST API wants to allow
you to continue an upload even if a single HTTP session fails or times out. This
is implemented by creating an upload object, POSTing data to that object repeatedly,
and then converting that upload object to an artifact.</p>
<p><em>Upload objects which have not have data posted to them in a long time (currently
24 hours) are automatically removed.</em></p>
<p>You create an upload by POST'ing to <code>/upload</code>. This will create a new upload
object and return you a JSON representation of that object. The JSON includes
the UUID, node the upload is stored on, and when it was created.</p>
<p>Then repeatedly POST binary data to <code>/upload/...uuid...</code>. This binary data is
blindly appended to your upload object. Do not encode the data with base64 or
similar. Each call will return the new size of the object.</p>
<p>If necessary, you can also truncate an upload object to a specified size, for
example if you are unsure that a POST operation completed correctly. You do this
by sending a POST to <code>/upload/...uuid.../truncate/...desired.length...</code>.</p>
<p>Once your upload is complete, you convert it to an artifact by calling
<code>/artifacts/upload/...name...</code> to convert it to an artifact.</p>
<p>There is one final optimization to uploads, which is implemented in the python
API and command line clients. If before upload you calculate a sha512 of the
object to be uploaded, you can then search for that checksum with the
<code>/blob_checksums/sha512/...hash...</code> endpoint. If a blob is returned then you
don't need to actually upload and can instead pass that blob uuid (with a POST
argument named <code>blob_uuid</code>) instead of an upload uuid to the
<code>/artifacts/upload/...name...</code> endpoint. See the swagger documentation for more
details.</p>
<details class="note" open="open">
<summary>Note</summary>
<p>For a detailed reference on the state machine for uploads, see the
<a href="/developer_guide/state_machine/#uploads">developer documentation on object states</a>.</p>
</details>
<details class="tip" open="open">
<summary>REST API calls</summary>
<ul>
<li><a href="https://sfcbr.shakenfist.com/api/apidocs/#/upload/post_upload">POST /upload</a>: Create a new upload.</li>
<li><a href="https://sfcbr.shakenfist.com/api/apidocs/#/upload/post_upload__upload_uuid_">POST /upload/{upload_uuid}</a>: Append a new chunk to an already existing upload.</li>
<li><a href="https://sfcbr.shakenfist.com/api/apidocs/#/upload/post_upload__upload_uuid__truncate__offset_">POST /upload/{upload_uuid}/truncate</a>: Truncate an upload to a specific index. This can be useful as a retry operation in the case of a transmission error.</li>
<li><a href="https://sfcbr.shakenfist.com/api/apidocs/#/artifacts/get_artifacts">GET /artifacts</a>: List artifacts.</li>
<li><a href="https://sfcbr.shakenfist.com/api/apidocs/#/artifacts/post_artifacts_upload__artifact_name_">POST /artifacts/upload/{artifact_name}</a>: Convert a completed upload into an artifact.</li>
</ul>
</details>
<details class="example">
<summary>Python API client: create an upload, transfer data, and convert to an artifact</summary>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">shakenfist_client</span> <span class="kn">import</span> <span class="n">apiclient</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">sf_client</span> <span class="o">=</span> <span class="n">apiclient</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
<span class="n">upload</span> <span class="o">=</span> <span class="n">sf_client</span><span class="o">.</span><span class="n">create_upload</span><span class="p">()</span>

<span class="n">buffer_size</span> <span class="o">=</span> <span class="mi">4096</span>
<span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">retries</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/tmp/input&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">buffer_size</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">d</span><span class="p">:</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">remote_total</span> <span class="o">=</span> <span class="n">sf_client</span><span class="o">.</span><span class="n">send_upload</span><span class="p">(</span><span class="n">upload</span><span class="p">[</span><span class="s1">&#39;uuid&#39;</span><span class="p">],</span> <span class="n">d</span><span class="p">)</span>
            <span class="n">retries</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">except</span> <span class="n">apiclient</span><span class="o">.</span><span class="n">APIException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">retries</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="n">retries</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Repeated failures, aborting&#39;</span><span class="p">)</span>
                <span class="k">raise</span> <span class="n">e</span>

            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Upload error, retrying...&#39;</span><span class="p">)</span>
            <span class="n">sf_client</span><span class="o">.</span><span class="n">truncate_upload</span><span class="p">(</span><span class="n">upload</span><span class="p">[</span><span class="s1">&#39;uuid&#39;</span><span class="p">],</span> <span class="n">total</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">total</span><span class="p">)</span>
            <span class="n">buffer_size</span> <span class="o">=</span> <span class="mi">4096</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">buffer_size</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="c1"># We aim for each chunk to take three seconds to transfer. This is</span>
        <span class="c1"># partially because of the API timeout on the other end, but also</span>
        <span class="c1"># so that uploads don&#39;t appear to stall over very slow networks.</span>
        <span class="c1"># However, the buffer size must also always be between 4kb and 4mb.</span>
        <span class="n">elapsed</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="n">buffer_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">buffer_size</span> <span class="o">*</span> <span class="mf">3.0</span> <span class="o">/</span> <span class="n">elapsed</span><span class="p">)</span>
        <span class="n">buffer_size</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">,</span> <span class="n">buffer_size</span><span class="p">)</span>
        <span class="n">buffer_size</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">,</span> <span class="n">buffer_size</span><span class="p">)</span>

        <span class="n">sent</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">total</span> <span class="o">+=</span> <span class="n">sent</span>

        <span class="k">if</span> <span class="n">total</span> <span class="o">!=</span> <span class="n">remote_total</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Remote side has </span><span class="si">%d</span><span class="s1">, we have sent </span><span class="si">%d</span><span class="s1">!&#39;</span>
                  <span class="o">%</span> <span class="p">(</span><span class="n">remote_total</span><span class="p">,</span> <span class="n">total</span><span class="p">))</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">d</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">buffer_size</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Creating artifact&#39;</span><span class="p">)</span>
    <span class="n">artifact</span> <span class="o">=</span> <span class="n">sf_client</span><span class="o">.</span><span class="n">upload_artifact</span><span class="p">(</span><span class="s1">&#39;example&#39;</span><span class="p">,</span> <span class="n">upload</span><span class="p">[</span><span class="s1">&#39;uuid&#39;</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Created artifact </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">artifact</span><span class="p">[</span><span class="s1">&#39;uuid&#39;</span><span class="p">])</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>$ python3 example.py
Creating artifact
Created artifact 2d9c1d4c-3436-4ea8-9b60-833fe791eece
$ sf-client artifact show 2d9c1d4c-3436-4ea8-9b60-833fe791eece
uuid                     : 2d9c1d4c-3436-4ea8-9b60-833fe791eece
namespace                : system
type                     : image
state                    : created
source url               : sf://upload/system/example
current version blob uuid: 36e846f6-ae20-46e9-8377-1c123f22b610
number of versions       : 1
maximum versions         : 3
shared                   : False

Versions:
    1  : blob 36e846f6-ae20-46e9-8377-1c123f22b610 is 1.3MB
$ sf-client artifact delete 2d9c1d4c-3436-4ea8-9b60-833fe791eece
</code></pre></div>
</details>
<h2 id="using-an-already-existing-blob-as-a-new-version-of-an-artifact">Using an already existing blob as a new version of an artifact</h2>
<p><em>Label</em> artifacts are effectively a sequence of already existing blobs which have
been categorized in some manner. For example, you might have a CI system producing
golden images for a system, but then use a label artifact to indicate the most
recent version of the golden image which has passed acceptance testing. You
therefore can apply an existing blob (the version of the golden image you tested in
our example), to an artifact as a new version.</p>
<h2 id="removing-a-specific-version-from-an-artifact">Removing a specific version from an artifact</h2>
<p>It is also possible that a bad version of an artifact exists -- possibly because
the system that creates the new versions experienced an error. You can therefore
remove a specific version of an artifact as well.</p>
<details class="tip" open="open">
<summary>REST API calls</summary>
<ul>
<li><a href="https://sfcbr.shakenfist.com/api/apidocs/#/artifacts/delete_artifacts__artifact_ref__versions__version_id_">DELETE /artifacts/{artifact_ref}/versions/{version_id}</a>: Remove a specified version from an artifact.</li>
</ul>
</details>
<details class="example">
<summary>Python API client: delete a specific version of an artifact</summary>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">shakenfist_client</span> <span class="kn">import</span> <span class="n">apiclient</span>

<span class="n">sf_client</span> <span class="o">=</span> <span class="n">apiclient</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
<span class="n">sf_client</span><span class="o">.</span><span class="n">delete_artifact_version</span><span class="p">(</span><span class="s1">&#39;2d9c1d4c-3436-4ea8-9b60-833fe791eece&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>
</details>
<h2 id="setting-the-maximum-number-of-versions-of-an-artifact">Setting the maximum number of versions of an artifact</h2>
<p>You can configure the number of versions a given artifact will store. The default
value is the ARTIFACT_MAX_VERSIONS_DEFAULT configuration variable, but that may be
overridden on a per-artifact basis.</p>
<details class="tip" open="open">
<summary>REST API calls</summary>
<ul>
<li><a href="https://sfcbr.shakenfist.com/api/apidocs/#/artifacts/get_artifacts__artifact_ref__versions">POST /artifacts/{artifact_ref}/versions</a>: Set the maximum number of versions of an artifact to store.</li>
</ul>
</details>
<details class="example">
<summary>Python API client: delete a specific version of an artifact</summary>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">shakenfist_client</span> <span class="kn">import</span> <span class="n">apiclient</span>

<span class="n">sf_client</span> <span class="o">=</span> <span class="n">apiclient</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
<span class="n">sf_client</span><span class="o">.</span><span class="n">set_artifact_max_versions</span><span class="p">(</span><span class="s1">&#39;2d9c1d4c-3436-4ea8-9b60-833fe791eece&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
</code></pre></div>
</details>
<h2 id="downloads">Downloads</h2>
<p>Artifact downloads are implemented as fetching the data for the desired blob. You
therefore must first lookup the versions for a given artifact and select a version
that you wish to download. You can then fetch the data for the relevant blob by
calling <code>/blobs/...uuid.../data</code> this call takes an optional query parameter of
<code>offset</code>, which specifies how many bytes into the blob to start returning data
from. This allows recommencing failed downloads.</p>
<details class="tip" open="open">
<summary>REST API calls</summary>
<ul>
<li><a href="https://sfcbr.shakenfist.com/api/apidocs/#/artifacts/get_artifacts__artifact_ref__versions">GET /artifacts/{artifact_ref}/versions</a>: List version blobs for a given artifact.</li>
</ul>
</details>
<details class="example">
<summary>Python API client: list versions of an artifact</summary>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">shakenfist_client</span> <span class="kn">import</span> <span class="n">apiclient</span>

<span class="n">sf_client</span> <span class="o">=</span> <span class="n">apiclient</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
<span class="n">vers</span> <span class="o">=</span> <span class="n">sf_client</span><span class="o">.</span><span class="n">get_artifact_versions</span><span class="p">(</span><span class="s1">&#39;2d9c1d4c-3436-4ea8-9b60-833fe791eece&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">vers</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</code></pre></div>
</details>
<h2 id="sharing-and-unsharing">Sharing and unsharing</h2>
<p>As described in the <a href="/operator_guide/artifacts/">operator guide</a>, artifacts in
the system namespace can be shared with all other namespaces. This is desirable
for commonly used "official" images which many users will want to use.</p>
<details class="tip" open="open">
<summary>REST API calls</summary>
<ul>
<li><a href="https://sfcbr.shakenfist.com/api/apidocs/#/artifacts/post_artifacts__artifact_ref__share">POST /artifacts/{artifact_ref}/share</a>: Share an artifact.</li>
<li><a href="https://sfcbr.shakenfist.com/api/apidocs/#/artifacts/post_artifacts__artifact_ref__unshare">POST /artifacts/{artifact_ref}/unshare</a>: Unshare an artifact.</li>
</ul>
</details>
<details class="example">
<summary>Python API client: share an artifact</summary>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">shakenfist_client</span> <span class="kn">import</span> <span class="n">apiclient</span>

<span class="n">sf_client</span> <span class="o">=</span> <span class="n">apiclient</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
<span class="n">sf_client</span><span class="o">.</span><span class="n">share_artifact</span><span class="p">(</span><span class="s1">&#39;2d9c1d4c-3436-4ea8-9b60-833fe791eece&#39;</span><span class="p">)</span>
</code></pre></div>
</details>
<details class="example">
<summary>Python API client: unshare an artifact</summary>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">shakenfist_client</span> <span class="kn">import</span> <span class="n">apiclient</span>

<span class="n">sf_client</span> <span class="o">=</span> <span class="n">apiclient</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
<span class="n">sf_client</span><span class="o">.</span><span class="n">unshare_artifact</span><span class="p">(</span><span class="s1">&#39;2d9c1d4c-3436-4ea8-9b60-833fe791eece&#39;</span><span class="p">)</span>
</code></pre></div>
</details>
<h2 id="metadata">Metadata</h2>
<p>All objects exposed by the REST API may have metadata associated with them. This
metadata is for storing values that are of interest to the owner of the resources,
not Shaken Fist. Shaken Fist does not attempt to interpret these values at all,
with the exception of the <a href="/user_guide/affinity/">instance affinity metadata values</a>.
The metadata store is in the form of a key value store, and a general introduction
is available <a href="/user_guide/metadata/">in the user guide</a>.</p>
<details class="tip" open="open">
<summary>REST API calls</summary>
<ul>
<li><a href="https://sfcbr.shakenfist.com/api/apidocs/#/artifacts/get_artifacts__artifact_ref__metadata">GET ​/artifacts​/{artifact_ref}​/metadata</a>: Get metadata for an artifact.</li>
<li><a href="https://sfcbr.shakenfist.com/api/apidocs/#/artifacts/post_artifacts__artifact_ref__metadata">POST /artifacts/{artifact_ref}/metadata</a>: Create a new metadata key for an artifact.</li>
<li><a href="https://sfcbr.shakenfist.com/api/apidocs/#/artifacts/delete_artifacts__artifact_ref__metadata__key_">DELETE /artifacts/{artifact_ref}/metadata/{key}</a>: Delete a specific metadata key for an artifact.</li>
<li><a href="https://sfcbr.shakenfist.com/api/apidocs/#/artifacts/put_artifacts__artifact_ref__metadata__key_">PUT /artifacts/{artifact_ref}/metadata/{key}</a>: Update an existing metadata key for an artifact.</li>
</ul>
</details>
<details class="example">
<summary>Python API client: set metadata on an artifact</summary>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">shakenfist_client</span> <span class="kn">import</span> <span class="n">apiclient</span>

<span class="n">sf_client</span> <span class="o">=</span> <span class="n">apiclient</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
<span class="n">sf_client</span><span class="o">.</span><span class="n">set_artifact_metadata_item</span><span class="p">(</span><span class="n">img_uuid</span><span class="p">,</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">)</span>
</code></pre></div>
</details>
<details class="example">
<summary>Python API client: get metadata for an artifact</summary>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">shakenfist_client</span> <span class="kn">import</span> <span class="n">apiclient</span>

<span class="n">sf_client</span> <span class="o">=</span> <span class="n">apiclient</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
<span class="n">md</span> <span class="o">=</span> <span class="n">sf_client</span><span class="o">.</span><span class="n">get_artifact_metadata</span><span class="p">(</span><span class="n">img_uuid</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</code></pre></div>
</details>
<details class="example">
<summary>Python API client: delete metadata for an artifact</summary>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">shakenfist_client</span> <span class="kn">import</span> <span class="n">apiclient</span>

<span class="n">sf_client</span> <span class="o">=</span> <span class="n">apiclient</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
<span class="n">sf_client</span><span class="o">.</span><span class="n">delete_artifact_metadata_item</span><span class="p">(</span><span class="n">img_uuid</span><span class="p">,</span> <span class="s1">&#39;foo&#39;</span><span class="p">)</span>
</code></pre></div>
</details>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.220ee61c.min.js"></script>
      
    
  </body>
</html>